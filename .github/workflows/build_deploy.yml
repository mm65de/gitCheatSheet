name: Build and Deploy
on:
  # push:
  # pull_request:
  workflow_dispatch:
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: shivammathur/setup-php@v2
        with:
          php-version: '7.4'
      - name: show php version
        run:  php --version
      - name: Process index.php
        run: cd src && php -f index.php > ../docs/index.html
      - name: Show generated output
        run: cat docs/index.html
      - name: commit and push generated file
        run: |
          /usr/bin/git config --global user.email "${{ secrets.GIT_USER_EMAIL }}"
          /usr/bin/git config --global user.name "${{ secrets.GIT_USER_NAME }}"
          /usr/bin/git add docs/index.html
          /usr/bin/git commit -m "Update generated html file automatically."
          /usr/bin/git push
      - name: Never use a secret value in echo command!
        run: echo "${{ secrets.MY_FIRST_SECRET }}"
